(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{347:()=>{},2044:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>a});var n=r(5155),i=r(2115),o=r(9230);function a(e){let{children:t}=e,[r,a]=(0,i.useState)(null),[s,l]=(0,i.useState)(null),[u,c]=(0,i.useState)(!0),[S,m]=(0,i.useState)(0),[g,f]=(0,i.useState)(!1),I=(0,i.useCallback)(()=>{let e=o.y1.getSession(),t=o.y1.getCurrentUser(),r=o.y1.getSessionTimeRemaining(),n=o.y1.isSessionNearExpiry();l(e),a(t),m(r),f(n)},[]);(0,i.useEffect)(()=>{let e=o.y1.initializeSessionManagement();I(),c(!1);let t=setInterval(I,3e4);return()=>{e&&e(),clearInterval(t)}},[I]);let d=async(e,t,r)=>{c(!0);try{let n=await o.y1.login(e,t,r);if(n.success&&n.user&&n.session)return a(n.user),l(n.session),I(),!0;return!1}catch(e){return console.error("Login error:",e),!1}finally{c(!1)}},v=async e=>{c(!0);try{if((await o.y1.signup(e)).success)return!0;return!1}catch(e){return console.error("Signup error:",e),!1}finally{c(!1)}},y=()=>{let e=o.y1.refreshSession();e&&(l(e),I())};return(0,n.jsx)(o.cy.Provider,{value:{user:r,isAuthenticated:!0,isLoading:u,session:s,sessionTimeRemaining:S,isSessionNearExpiry:g,login:d,logout:()=>{o.y1.logout(),a(null),l(null),m(0),f(!1)},signup:v,refreshSession:y,extendSession:()=>{y()}},children:t})}},5356:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_f367f3"}},6754:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,5356,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,2044))},9230:(e,t,r)=>{"use strict";r.d(t,{cy:()=>m,y1:()=>f,As:()=>g});var n=r(2115);let i={defaultExpiration:864e5,rememberMeExpiration:2592e6,inactivityTimeout:72e5,warningBeforeExpiry:3e5},o={SESSION:"tailadmin_session",LAST_ACTIVITY:"tailadmin_last_activity",SESSION_FINGERPRINT:"tailadmin_fingerprint"};function a(e){try{let t=JSON.stringify(e);return btoa(t)}catch(e){return console.error("Error encrypting session data:",e),""}}function s(e){try{let t=atob(e);return JSON.parse(t)}catch(e){return console.error("Error decrypting session data:",e),null}}function l(){let e=Date.now().toString(),t=Array.from(crypto.getRandomValues(new Uint8Array(16))).map(e=>e.toString(16).padStart(2,"0")).join("");return btoa("".concat(e,"-").concat(t)).replace(/[+/=]/g,"")}function u(e){return Date.now()>e.expiresAt}function c(){localStorage.setItem(o.LAST_ACTIVITY,Date.now().toString())}function S(){let e=localStorage.getItem(o.SESSION);if(e){let t=s(e);t&&u(t)&&(localStorage.removeItem(o.SESSION),localStorage.removeItem(o.LAST_ACTIVITY),localStorage.removeItem(o.SESSION_FINGERPRINT))}}let m=(0,n.createContext)(void 0);function g(){let e=(0,n.useContext)(m);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}let f={saveSession:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Date.now(),n=t?i.rememberMeExpiration:i.defaultExpiration,s={user:e,token:l(),expiresAt:r+n,loginTime:r,rememberMe:t,fingerprint:function(){let e=document.createElement("canvas"),t=e.getContext("2d");return t&&(t.textBaseline="top",t.font="14px Arial",t.fillText("Session fingerprint",2,2)),btoa([navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),e.toDataURL()].join("|")).slice(0,32)}()},u=a(s);return localStorage.setItem(o.SESSION,u),localStorage.setItem(o.SESSION_FINGERPRINT,s.fingerprint),c(),s},getSession:()=>{try{let e=localStorage.getItem(o.SESSION);if(!e)return null;let t=s(e);if(!t)return null;if(u(t)||function(){let e=localStorage.getItem(o.LAST_ACTIVITY);return!e||Date.now()-parseInt(e)>i.inactivityTimeout}()||localStorage.getItem(o.SESSION_FINGERPRINT)!==t.fingerprint)return f.clearSession(),null;return t}catch(e){return console.error("Error retrieving session:",e),f.clearSession(),null}},clearSession:()=>{localStorage.removeItem(o.SESSION),localStorage.removeItem(o.LAST_ACTIVITY),localStorage.removeItem(o.SESSION_FINGERPRINT),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("user")},isSessionValid:()=>null!==f.getSession(),refreshSession:()=>{let e=f.getSession();if(!e)return null;let t=Date.now(),r=e.rememberMe?i.rememberMeExpiration:i.defaultExpiration,n={...e,expiresAt:t+r,token:l()},s=a(n);return localStorage.setItem(o.SESSION,s),c(),n},login:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await new Promise(e=>setTimeout(e,1e3)),e&&t){let t={id:"1",email:e,name:"admin@tailadmin.com"===e?"Musharof":"User",avatar:"/placeholder-avatar.jpg"},n=f.saveSession(t,r);return{success:!0,user:t,session:n}}return{success:!1}},signup:async e=>{await new Promise(e=>setTimeout(e,1500));let t={id:Date.now().toString(),email:e.email,name:e.fullName};return localStorage.setItem("registeredUser",JSON.stringify(t)),{success:!0,user:t}},logout:()=>{f.clearSession()},getCurrentUser:()=>{let e=f.getSession();return(null==e?void 0:e.user)||null},isAuthenticated:()=>f.isSessionValid(),getSessionTimeRemaining:()=>{let e=f.getSession();return e?Math.max(0,e.expiresAt-Date.now()):0},isSessionNearExpiry:()=>{let e=f.getSession();return!!e&&function(e){let t=e.expiresAt-Date.now();return t<=i.warningBeforeExpiry&&t>0}(e)},initializeSessionManagement:()=>{S();let e=function(){let e=["mousedown","mousemove","keypress","scroll","touchstart","click"],t=()=>{c()};return e.forEach(e=>{document.addEventListener(e,t,{passive:!0})}),()=>{e.forEach(e=>{document.removeEventListener(e,t)})}}();document.addEventListener("visibilitychange",()=>{document.hidden||(c(),S())});let t=setInterval(()=>{let e=f.getSession();e&&u(e)&&(f.clearSession(),window.location.href="/login")},6e4);return()=>{e&&e(),clearInterval(t)}}}}},e=>{var t=t=>e(e.s=t);e.O(0,[9897,7690,8441,1684,7358],()=>t(6754)),_N_E=e.O()}]);