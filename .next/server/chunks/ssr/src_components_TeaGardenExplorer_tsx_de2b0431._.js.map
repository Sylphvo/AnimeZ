{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/phuvm/source/repos/AnimeZ/src/components/TeaGardenExplorer.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useRef, useState, useCallback } from 'react'\r\nimport * as THREE from 'three'\r\n// GLTFLoader will be imported dynamically inside loadCharacter to avoid TypeScript module/typing errors\r\n\r\ninterface Movement {\r\n  forward: boolean\r\n  backward: boolean\r\n  left: boolean\r\n  right: boolean\r\n  jump: boolean\r\n  shift: boolean\r\n}\r\n\r\ninterface Translations {\r\n  [key: string]: {\r\n    controlsWasd: string\r\n    controlsSpace: string\r\n    controlsShift: string\r\n    loadingText: string\r\n    loadingWait: string\r\n  }\r\n}\r\n\r\n\r\n\r\nconst TRANSLATIONS: Translations = {\r\n  \"en-US\": {\r\n    \"controlsWasd\": \"WASD/Arrow Keys: Move\",\r\n    \"controlsSpace\": \"Space: Jump\",\r\n    \"controlsShift\": \"Shift: Run\",\r\n    \"loadingText\": \"Loading Tea Garden\",\r\n    \"loadingWait\": \"Please wait...\"\r\n  },\r\n  \"es-ES\": {\r\n    \"controlsWasd\": \"WASD/Flechas: Mover\",\r\n    \"controlsSpace\": \"Espacio: Saltar\",\r\n    \"controlsShift\": \"Shift: Correr\",\r\n    \"loadingText\": \"Cargando Jardín de Té\",\r\n    \"loadingWait\": \"Por favor espere...\"\r\n  },\r\n  \"vi-VN\": {\r\n    \"controlsWasd\": \"WASD/Mũi tên: Di chuyển\",\r\n    \"controlsSpace\": \"Space: Nhảy\",\r\n    \"controlsShift\": \"Shift: Chạy\",\r\n    \"loadingText\": \"Đang tải Vườn Trà\",\r\n    \"loadingWait\": \"Vui lòng đợi...\"\r\n  }\r\n}\r\n\r\nexport default function TeaGardenExplorer() {\r\n  const mountRef = useRef<HTMLDivElement>(null)\r\n  const sceneRef = useRef<THREE.Scene | null>(null)\r\n  const rendererRef = useRef<THREE.WebGLRenderer | null>(null)\r\n  const cameraRef = useRef<THREE.PerspectiveCamera | null>(null)\r\n  const animationIdRef = useRef<number | undefined>(undefined)\r\n  const handsRef = useRef<THREE.Group | null>(null)\r\n  const characterRef = useRef<THREE.Group | null>(null)\r\n  const [thirdPerson, setThirdPerson] = useState(false)\r\n  //const clockRef = useRef<THREE.Clock>(new THREE.Clock())\r\n\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [locale, setLocale] = useState<keyof typeof TRANSLATIONS>('en-US')\r\n\r\n  // Invert mouse options\r\n  const [invertY, setInvertY] = useState(false)\r\n  const [invertX, setInvertX] = useState(false)\r\n\r\n  // Toggle for optional physics engine (cannon-es)\r\n  const [usePhysicsEngine, setUsePhysicsEngine] = useState(false)\r\n  \r\n  // Game state refs\r\n  const movementRef = useRef<Movement>({\r\n    forward: false,\r\n    backward: false,\r\n    left: false,\r\n    right: false,\r\n    jump: false,\r\n    shift: false\r\n  })\r\n\r\n  const mouseRef = useRef({ phi: 0, theta: 0 })\r\n  const physicsRef = useRef({ yVelocity: 0, isGrounded: true })\r\n  const playerRef = useRef(new THREE.Vector3(0, 1.6, 0)) // first-person player position\r\n  const EYE_HEIGHT = 1.6\r\n\r\n  // Physics-related refs (dynamically set when cannon-es is loaded)\r\n  const physicsWorldRef = useRef<any | null>(null)\r\n  const playerBodyRef = useRef<any | null>(null)\r\n  const cannonRef = useRef<any | null>(null)\r\n\r\n  // Trees group ref used for simple collision detection\r\n  const treesGroupRef = useRef<THREE.Group | null>(null)\r\n\r\n  // Player collision radius used by simple physics / cannon body\r\n  const PLAYER_RADIUS = 0.3\r\n  //const chunksRef = useRef<Map<string, THREE.Group>>(new Map())\r\n  //const loadedChunksRef = useRef<Set<string>>(new Set())\r\n\r\n  // Constants\r\n  const CHUNK_SIZE = 50;\r\n  const GRAVITY = -0.015;\r\n  const JUMP_POWER = 0.3;\r\n\r\n  // Translation helper\r\n  const t = useCallback((key: keyof typeof TRANSLATIONS['en-US']) => {\r\n    return TRANSLATIONS[locale]?.[key] || TRANSLATIONS['en-US'][key] || key\r\n  }, [locale])\r\n\r\n  // Detect locale\r\n  useEffect(() => {\r\n    const browserLocale = navigator.languages?.[0] || navigator.language || 'en-US'\r\n    const findMatchingLocale = (locale: string) => {\r\n      if (TRANSLATIONS[locale]) return locale\r\n      const lang = locale.split('-')[0]\r\n      const match = Object.keys(TRANSLATIONS).find(key => key.startsWith(lang + '-'))\r\n      return match || 'en-US'\r\n    }\r\n    setLocale(findMatchingLocale(browserLocale))\r\n  }, [])\r\n\r\n  // Texture creation\r\n  const createTextures = useCallback(() => {\r\n    // Create grass texture\r\n    const canvas = document.createElement('canvas')\r\n    canvas.width = 256\r\n    canvas.height = 256\r\n    const context = canvas.getContext('2d')!\r\n    context.fillStyle = '#3a5f3a'\r\n    context.fillRect(0, 0, 256, 256)\r\n    // Add some noise for grass\r\n    for (let i = 0; i < 1000; i++) {\r\n      context.fillStyle = `hsl(${80 + Math.random() * 20}, 50%, ${30 + Math.random() * 20}%)`\r\n      context.fillRect(Math.random() * 256, Math.random() * 256, 1, 1)\r\n    }\r\n    const grassTexture = new THREE.CanvasTexture(canvas)\r\n    grassTexture.wrapS = THREE.RepeatWrapping\r\n    grassTexture.wrapT = THREE.RepeatWrapping\r\n    grassTexture.repeat.set(10, 10)\r\n    return { grassTexture }\r\n  }, [])\r\n\r\n  // Material creation\r\n  const createMaterials = useCallback((textures: any) => {\r\n    return {\r\n      grass: new THREE.MeshLambertMaterial({ color: 0x3a5f3a, map: textures.grassTexture }),\r\n      mossyGrass: new THREE.MeshLambertMaterial({ color: 0x4a6f4a }),\r\n      water: new THREE.MeshPhongMaterial({\r\n        color: 0x4682B4,\r\n        shininess: 100,\r\n        transparent: true,\r\n        opacity: 0.8\r\n      }),\r\n      stone: new THREE.MeshLambertMaterial({ color: 0x808080 }),\r\n      wood: new THREE.MeshLambertMaterial({ color: 0x8B4513 }),\r\n      trunk: new THREE.MeshLambertMaterial({ color: 0x4a3c28 }),\r\n      lantern: new THREE.MeshPhongMaterial({\r\n        color: 0xff6b35,\r\n        emissive: 0xff6b35,\r\n        emissiveIntensity: 0.2\r\n      }),\r\n      teaPlant: new THREE.MeshLambertMaterial({ color: 0x228B22 })\r\n    }\r\n  }, [])\r\n\r\n  // Tea plant creation with InstancedMesh\r\n  const createTeaPlants = useCallback((materials: any) => {\r\n    const geometry = new THREE.SphereGeometry(0.3, 8, 6)\r\n    const instancedMesh = new THREE.InstancedMesh(geometry, materials.teaPlant, 200)\r\n    const matrix = new THREE.Matrix4()\r\n    const position = new THREE.Vector3()\r\n    const rotation = new THREE.Euler()\r\n    const scale = new THREE.Vector3()\r\n    for (let i = 0; i < 200; i++) {\r\n      position.set(\r\n        (Math.random() - 0.5) * CHUNK_SIZE,\r\n        0.3,\r\n        (Math.random() - 0.5) * CHUNK_SIZE\r\n      )\r\n      rotation.set(\r\n        0,\r\n        Math.random() * Math.PI * 2,\r\n        0\r\n      )\r\n      scale.setScalar(0.5 + Math.random() * 0.5)\r\n      matrix.makeRotationFromEuler(rotation)\r\n      matrix.setPosition(position)\r\n      matrix.scale(scale)\r\n      instancedMesh.setMatrixAt(i, matrix)\r\n    }\r\n    instancedMesh.castShadow = true\r\n    return instancedMesh\r\n  }, [])\r\n\r\n  // Ground plane creation (keep a subtle ground but not dominating grass)\r\n  const createGround = useCallback((materials: any) => {\r\n    const geometry = new THREE.PlaneGeometry(CHUNK_SIZE * 2, CHUNK_SIZE * 2)\r\n    // use mossyGrass/stone instead of bright grass\r\n    const ground = new THREE.Mesh(geometry, materials.mossyGrass || materials.grass)\r\n    ground.rotation.x = -Math.PI / 2\r\n    ground.receiveShadow = true\r\n    return ground\r\n  }, [])\r\n\r\n  // Sky gradient\r\n  const createSky = useCallback(() => {\r\n    const skyGeometry = new THREE.SphereGeometry(1000, 32, 32)\r\n    const skyMaterial = new THREE.ShaderMaterial({\r\n      vertexShader: `\r\n        varying vec3 vWorldPosition;\r\n        void main() {\r\n          vec4 worldPosition = modelMatrix * vec4(position, 1.0);\r\n          vWorldPosition = worldPosition.xyz;\r\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n        }\r\n      `,\r\n      fragmentShader: `\r\n        varying vec3 vWorldPosition;\r\n        void main() {\r\n          vec3 skyColor = vec3(0.5, 0.7, 1.0); // Light blue\r\n          vec3 groundColor = vec3(0.1, 0.1, 0.1); // Dark\r\n          float h = normalize(vWorldPosition).y;\r\n          gl_FragColor = vec4(mix(groundColor, skyColor, max(pow(max(h, 0.0), 0.8), 0.0)), 1.0);\r\n        }\r\n      `,\r\n      side: THREE.BackSide\r\n    })\r\n    const sky = new THREE.Mesh(skyGeometry, skyMaterial)\r\n    return sky\r\n  }, [])\r\n\r\n  // Lighting setup\r\n  const setupLighting = useCallback((scene: THREE.Scene) => {\r\n    const ambientLight = new THREE.AmbientLight(0x404040, 0.4)\r\n    scene.add(ambientLight)\r\n\r\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8)\r\n    directionalLight.position.set(50, 50, 25)\r\n    directionalLight.castShadow = true\r\n    directionalLight.shadow.mapSize.width = 2048\r\n    directionalLight.shadow.mapSize.height = 2048\r\n    directionalLight.shadow.camera.near = 0.5\r\n    directionalLight.shadow.camera.far = 500\r\n    directionalLight.shadow.camera.left = -100\r\n    directionalLight.shadow.camera.right = 100\r\n    directionalLight.shadow.camera.top = 100\r\n    directionalLight.shadow.camera.bottom = -100\r\n    scene.add(directionalLight)\r\n  }, [])\r\n\r\n  // Fog setup\r\n  const setupFog = useCallback((scene: THREE.Scene) => {\r\n    scene.fog = new THREE.Fog(0x87CEEB, 50, 200)\r\n  }, [])\r\n\r\n  // Initialization\r\n  useEffect(() => {\r\n    if (!mountRef.current) return\r\n\r\n    // Create scene\r\n    const scene = new THREE.Scene()\r\n    sceneRef.current = scene\r\n\r\n    // Create camera\r\n    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000)\r\n    // first-person: start at player eye height and use YXZ order so yaw (Y) is applied before pitch (X)\r\n    camera.rotation.order = 'YXZ'\r\n    camera.position.copy(playerRef.current)\r\n    cameraRef.current = camera\r\n\r\n    // Create renderer\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true })\r\n    renderer.setSize(window.innerWidth, window.innerHeight)\r\n    renderer.shadowMap.enabled = true\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap\r\n    rendererRef.current = renderer\r\n    mountRef.current.appendChild(renderer.domElement)\r\n\r\n    // Create textures and materials\r\n    const textures = createTextures()\r\n    const materials = createMaterials(textures)\r\n\r\n    // Load character model (try glTF in public/models/character.glb), fallback to simple placeholder\r\n        const loadCharacter = async () => {\r\n          try {\r\n            // dynamically import GLTFLoader at runtime; use ts-ignore to avoid TS compile-time module errors\r\n            // @ts-ignore\r\n            const { GLTFLoader } = await import('three/examples/jsm/loaders/GLTFLoader')\r\n            const loader = new GLTFLoader()\r\n            const gltf = await loader.loadAsync('/models/character.glb')\r\n            const root = gltf.scene\r\n            root.traverse((c: any) => {\r\n              if (c.isMesh) {\r\n                c.castShadow = true\r\n                c.receiveShadow = true\r\n              }\r\n            })\r\n            root.scale.set(1, 1, 1)\r\n            root.position.copy(playerRef.current)\r\n            characterRef.current = root\r\n            scene.add(root)\r\n          } catch (e) {\r\n            // fallback placeholder\r\n            const placeholder = new THREE.Group()\r\n            const body = new THREE.BoxGeometry(0.6, 1.6, 0.4)\r\n            const mat = materials.wood || new THREE.MeshStandardMaterial({ color: 0x996644 })\r\n            const mesh = new THREE.Mesh(body, mat)\r\n            mesh.castShadow = true\r\n            mesh.position.set(0, 0.8, 0)\r\n            placeholder.add(mesh)\r\n            placeholder.position.copy(playerRef.current)\r\n            characterRef.current = placeholder\r\n            scene.add(placeholder)\r\n          }\r\n        }\r\n    loadCharacter()\r\n\r\n    // Create first-person hands and attach to camera\r\n    const hands = createHands(materials)\r\n    handsRef.current = hands\r\n    camera.add(hands) // attach so hands follow camera transforms\r\n\r\n    const ground = createGround(materials)\r\n    scene.add(ground)\r\n\r\n    // Add trees instead of dense grass/tea plant field\r\n    const treesGroup = createTrees(materials, 80, CHUNK_SIZE) // adjust count as needed\r\n    treesGroupRef.current = treesGroup\r\n    scene.add(treesGroup)\r\n\r\n    // Optional: keep some small shrubs as instanced meshes\r\n    // const teaBushes = createTeaPlants(materials)\r\n    // scene.add(teaBushes)\r\n\r\n    // Add sky\r\n    const sky = createSky()\r\n    scene.add(sky)\r\n\r\n    // Setup lighting\r\n    setupLighting(scene)\r\n\r\n    // Setup fog\r\n    setupFog(scene)\r\n\r\n    // Add a checkers board (size 8, square = 1 unit) placed ahead of the camera\r\n    const checkers = createCheckersBoard(materials, 8, 1, { position: new THREE.Vector3(0, 0.05, -10) })\r\n    scene.add(checkers)\r\n    \r\n    // Add tea plants\r\n    const teaPlants = createTeaPlants(materials)\r\n    scene.add(teaPlants)\r\n    \r\n    // Add trees (duplicate-safe)\r\n    const trees = createTrees(materials, 60, CHUNK_SIZE)\r\n    scene.add(trees)\r\n\r\n    setIsLoading(false)\r\n\r\n    // Animation loop\r\n    const animate = () => {\r\n      animationIdRef.current = requestAnimationFrame(animate)\r\n\r\n      // hands bob / sway — safe-guard refs\r\n      const handsGroup = handsRef.current\r\n      if (handsGroup) {\r\n        const t = performance.now() / 1000\r\n        const movement = movementRef.current\r\n        const isMoving = movement.forward || movement.backward || movement.left || movement.right\r\n        const walkSpeed = isMoving ? 8 : 2\r\n        const bobAmp = isMoving ? 0.04 : 0.01\r\n        // vertical bob\r\n        handsGroup.position.y = -0.2 + Math.sin(t * walkSpeed) * bobAmp\r\n        // small forward/back tilt\r\n        handsGroup.rotation.x = Math.sin(t * walkSpeed * 1.2) * bobAmp * 0.7\r\n        // slight sway when strafing\r\n        const strafe = (movement.left ? -1 : 0) + (movement.right ? 1 : 0)\r\n        handsGroup.rotation.z = strafe * 0.1 * (isMoving ? 1 : 0)\r\n      }\r\n\r\n      renderer.render(scene, camera)\r\n    }\r\n    animate()\r\n    \r\n    // Cleanup\r\n    return () => {\r\n      if (animationIdRef.current) {\r\n        cancelAnimationFrame(animationIdRef.current)\r\n      }\r\n      // detach hands from camera\r\n      if (handsRef.current && camera) {\r\n        camera.remove(handsRef.current)\r\n      }\r\n      if (mountRef.current && renderer.domElement) {\r\n        mountRef.current?.removeChild(renderer.domElement)\r\n      }\r\n      // cleanup physics if created\r\n      if (physicsWorldRef.current) {\r\n        try {\r\n          physicsWorldRef.current.bodies?.forEach((b: any) => physicsWorldRef.current.removeBody(b))\r\n        } catch {}\r\n        physicsWorldRef.current = null\r\n        playerBodyRef.current = null\r\n        cannonRef.current = null\r\n      }\r\n      renderer.dispose()\r\n    }\r\n  }, []) // keep single scene init\r\n\r\n  // Physics engine init / teardown (cannon-es) — dynamic import when toggle enabled\r\n  useEffect(() => {\r\n    if (!usePhysicsEngine || !sceneRef.current) {\r\n      // if disabling physics, teardown existing world\r\n      if (physicsWorldRef.current) {\r\n        try {\r\n          physicsWorldRef.current.bodies?.forEach((b: any) => physicsWorldRef.current.removeBody(b))\r\n        } catch {}\r\n        physicsWorldRef.current = null\r\n        playerBodyRef.current = null\r\n        cannonRef.current = null\r\n      }\r\n      return\r\n    }\r\n\r\n    let cancelled = false\r\n    ;(async () => {\r\n      try {\r\n        const CANNON = await import('cannon-es')\r\n        if (cancelled) return\r\n        cannonRef.current = CANNON\r\n        const world = new CANNON.World()\r\n        world.broadphase = new CANNON.NaiveBroadphase()\r\n        ;(world.solver as any).iterations = 10\r\n        world.gravity.set(0, -9.82, 0)\r\n        physicsWorldRef.current = world\r\n\r\n        // create ground body (large static plane)\r\n        const groundBody = new CANNON.Body({ mass: 0 })\r\n        const groundShape = new CANNON.Plane()\r\n        groundBody.addShape(groundShape)\r\n        groundBody.quaternion.setFromEuler(-Math.PI / 2, 0, 0)\r\n        groundBody.position.set(0, 0, 0)\r\n        world.addBody(groundBody)\r\n\r\n        // create player body (sphere approx)\r\n        const playerShape = new CANNON.Sphere(PLAYER_RADIUS)\r\n        const playerBody = new CANNON.Body({ mass: 1, shape: playerShape, fixedRotation: true })\r\n        playerBody.position.set(playerRef.current.x, playerRef.current.y, playerRef.current.z)\r\n        playerBody.linearDamping = 0.9\r\n        playerBody.collisionFilterGroup = 1\r\n        world.addBody(playerBody)\r\n        playerBodyRef.current = playerBody\r\n\r\n        // create static bodies for trees to block player\r\n        const treesGroup = treesGroupRef.current\r\n        if (treesGroup) {\r\n          treesGroup.children.forEach((tree: any) => {\r\n            const pos = tree.position\r\n            const radius = 0.6 * (tree.scale.x || 1)\r\n            const shape = new CANNON.Sphere(radius)\r\n            const body = new CANNON.Body({ mass: 0 })\r\n            body.addShape(shape)\r\n            body.position.set(pos.x, pos.y + 1, pos.z) // trunk approx center\r\n            world.addBody(body)\r\n          })\r\n        }\r\n\r\n        // simple step loop: run in a timer to keep physics updated\r\n        const step = () => {\r\n          if (!physicsWorldRef.current) return\r\n          const fixedTimeStep = 1.0 / 60.0\r\n          physicsWorldRef.current.step(fixedTimeStep)\r\n          // sync playerRef from body\r\n          if (playerBodyRef.current) {\r\n            const p = playerBodyRef.current.position\r\n            playerRef.current.set(p.x, p.y, p.z)\r\n          }\r\n        }\r\n        const interval = setInterval(step, 1000 / 60)\r\n\r\n        return () => {\r\n          clearInterval(interval)\r\n        }\r\n      } catch (err) {\r\n        // dynamic import failed: notify user in console\r\n        console.error('Failed to load cannon-es; install it with `npm i cannon-es` to enable physics', err)\r\n        setUsePhysicsEngine(false)\r\n      }\r\n    })()\r\n\r\n    return () => { cancelled = true }\r\n  }, [usePhysicsEngine])\r\n\r\n  // Event listeners\r\n  useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      switch (event.code) {\r\n        case 'KeyW':\r\n        case 'ArrowUp':\r\n          movementRef.current.forward = true\r\n          break\r\n        case 'KeyS':\r\n        case 'ArrowDown':\r\n          movementRef.current.backward = true\r\n          break\r\n        case 'KeyA':\r\n        case 'ArrowLeft':\r\n          movementRef.current.left = true\r\n          break\r\n        case 'KeyD':\r\n        case 'ArrowRight':\r\n          movementRef.current.right = true\r\n          break\r\n        case 'Space':\r\n          if (physicsRef.current.isGrounded) {\r\n            physicsRef.current.yVelocity = JUMP_POWER\r\n            physicsRef.current.isGrounded = false\r\n          }\r\n          break\r\n        case 'ShiftLeft':\r\n        case 'ShiftRight':\r\n          movementRef.current.shift = true\r\n          break\r\n      }\r\n    }\r\n\r\n    const handleKeyUp = (event: KeyboardEvent) => {\r\n      switch (event.code) {\r\n        case 'KeyW':\r\n        case 'ArrowUp':\r\n          movementRef.current.forward = false\r\n          break\r\n        case 'KeyS':\r\n        case 'ArrowDown':\r\n          movementRef.current.backward = false\r\n          break\r\n        case 'KeyA':\r\n        case 'ArrowLeft':\r\n          movementRef.current.left = false\r\n          break\r\n        case 'KeyD':\r\n        case 'ArrowRight':\r\n          movementRef.current.right = false\r\n          break\r\n        case 'ShiftLeft':\r\n        case 'ShiftRight':\r\n          movementRef.current.shift = false\r\n          break\r\n      }\r\n    }\r\n\r\n    const handleMouseMove = (event: MouseEvent) => {\r\n      if (!document.pointerLockElement) return\r\n      const signX = invertX ? -1 : 1\r\n      const signY = invertY ? -1 : 1\r\n      // horizontal (theta) and vertical (phi). adjust signs to invert axes.\r\n      mouseRef.current.theta += event.movementX * 0.002 * signX\r\n      mouseRef.current.phi -= event.movementY * 0.002 * signY\r\n      mouseRef.current.phi = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, mouseRef.current.phi))\r\n    }\r\n    \r\n    const handleClick = () => {\r\n      if (mountRef.current) {\r\n        mountRef.current.requestPointerLock()\r\n      }\r\n    }\r\n    \r\n    window.addEventListener('keydown', handleKeyDown)\r\n    window.addEventListener('keyup', handleKeyUp)\r\n    window.addEventListener('mousemove', handleMouseMove)\r\n    if (mountRef.current) {\r\n      mountRef.current.addEventListener('click', handleClick)\r\n    }\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown)\r\n      window.removeEventListener('keyup', handleKeyUp)\r\n      window.removeEventListener('mousemove', handleMouseMove)\r\n      if (mountRef.current) {\r\n        mountRef.current.removeEventListener('click', handleClick)\r\n      }\r\n    }\r\n  }, [invertX, invertY])\r\n\r\n  // Movement and physics (use physics engine when enabled, otherwise kinematic + simple collision)\r\n  useEffect(() => {\r\n    const updateMovement = () => {\r\n      if (!cameraRef.current) return\r\n\r\n      const camera = cameraRef.current\r\n      const movement = movementRef.current\r\n      const physics = physicsRef.current\r\n      const player = playerRef.current\r\n      const speed = movement.shift ? 0.2 : 0.1\r\n\r\n      // If physics engine enabled, control playerBody velocity instead of manual position\r\n      if (usePhysicsEngine && playerBodyRef.current && physicsWorldRef.current) {\r\n        const CANNON = cannonRef.current\r\n        const body = playerBodyRef.current\r\n        // compute desired horizontal velocity in world XZ plane\r\n        const forward = new THREE.Vector3()\r\n        camera.getWorldDirection(forward)\r\n        forward.y = 0\r\n        forward.normalize()\r\n        const right = new THREE.Vector3().crossVectors(forward, new THREE.Vector3(0,1,0)).normalize()\r\n        const vel = new CANNON.Vec3(0, body.velocity.y, 0)\r\n        if (movement.forward) vel.vadd(new CANNON.Vec3(forward.x * speed * 60, 0, forward.z * speed * 60), vel)\r\n        if (movement.backward) vel.vadd(new CANNON.Vec3(-forward.x * speed * 60, 0, -forward.z * speed * 60), vel)\r\n        if (movement.left) vel.vadd(new CANNON.Vec3(-right.x * speed * 60, 0, -right.z * speed * 60), vel)\r\n        if (movement.right) vel.vadd(new CANNON.Vec3(right.x * speed * 60, 0, right.z * speed * 60), vel)\r\n        // apply velocity (keep y from physics)\r\n        body.velocity.set(vel.x, body.velocity.y, vel.z)\r\n        // jump\r\n        if (movement.jump && Math.abs(body.velocity.y) < 0.001) {\r\n          body.velocity.y = JUMP_POWER * 50\r\n        }\r\n        // update playerRef from body (physics loop also updates periodically)\r\n        const p = body.position\r\n        playerRef.current.set(p.x, p.y, p.z)\r\n      } else {\r\n        // Kinematic movement (existing): compute candidate position then check collisions with trees (simple sphere check)\r\n        // Apply camera rotation from mouse for direction vectors\r\n        camera.rotation.x = mouseRef.current.phi\r\n        camera.rotation.y = mouseRef.current.theta\r\n        camera.rotation.z = 0\r\n\r\n        const dir = new THREE.Vector3()\r\n        camera.getWorldDirection(dir)\r\n        dir.y = 0\r\n        dir.normalize()\r\n        const right = new THREE.Vector3()\r\n        right.crossVectors(dir, new THREE.Vector3(0, 1, 0)).normalize()\r\n\r\n        const candidate = player.clone()\r\n        if (movement.forward) candidate.addScaledVector(dir, speed)\r\n        if (movement.backward) candidate.addScaledVector(dir, -speed)\r\n        if (movement.left) candidate.addScaledVector(right, -speed)\r\n        if (movement.right) candidate.addScaledVector(right, speed)\r\n\r\n        // simple collision vs treesGroupRef: don't move inside tree radius\r\n        const trees = treesGroupRef.current\r\n        let blocked = false\r\n        if (trees) {\r\n          for (const t of trees.children as any) {\r\n            const dx = candidate.x - t.position.x\r\n            const dz = candidate.z - t.position.z\r\n            const dist2 = dx*dx + dz*dz\r\n            const minDist = (PLAYER_RADIUS + 0.6 * (t.scale.x || 1)) ** 2\r\n            if (dist2 < minDist) {\r\n              blocked = true\r\n              break\r\n            }\r\n          }\r\n        }\r\n\r\n        if (!blocked) {\r\n          player.copy(candidate)\r\n        }\r\n\r\n        // Physics fallback vertical\r\n        physics.yVelocity += GRAVITY\r\n        player.y += physics.yVelocity\r\n        if (player.y <= EYE_HEIGHT) {\r\n          player.y = EYE_HEIGHT\r\n          physics.yVelocity = 0\r\n          physics.isGrounded = true\r\n        }\r\n      }\r\n\r\n      // Update camera depending on view mode\r\n      if (thirdPerson) {\r\n        // place camera behind and above the player\r\n        const back = new THREE.Vector3(0, 0, 1).applyEuler(new THREE.Euler(0, mouseRef.current.theta, 0))\r\n        const camPos = player.clone().addScaledVector(back, 3) // 3 units behind\r\n        camPos.y = player.y + 1.6\r\n        camera.position.lerp(camPos, 0.2)\r\n        camera.lookAt(player.x, player.y + 1.0, player.z)\r\n      } else {\r\n        // first-person\r\n        camera.position.copy(player)\r\n      }\r\n\r\n      // sync character model (visible in third-person)\r\n      if (characterRef.current) {\r\n        const char = characterRef.current\r\n        char.position.lerp(new THREE.Vector3(player.x, 0, player.z), 0.3)\r\n        char.rotation.y = mouseRef.current.theta\r\n        char.visible = thirdPerson\r\n      }\r\n    }\r\n\r\n    const interval = setInterval(updateMovement, 16) // ~60fps\r\n \r\n    return () => clearInterval(interval)\r\n  }, [thirdPerson, usePhysicsEngine])\r\n\r\n  return (\r\n    <div className=\"w-full h-screen relative\">\r\n      <div ref={mountRef} className=\"w-full h-full\" />\r\n      {isLoading && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 text-white\">\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl mb-4\">{t('loadingText')}</div>\r\n            <div>{t('loadingWait')}</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n     {/* Invert mouse controls */}\r\n     <div className=\"absolute top-4 right-4 text-white bg-black bg-opacity-50 p-2 rounded\">\r\n       <label className=\"flex items-center gap-2\">\r\n         <input type=\"checkbox\" checked={invertY} onChange={() => setInvertY(v => !v)} />\r\n         <span className=\"text-sm\">Invert Y</span>\r\n       </label>\r\n       <label className=\"flex items-center gap-2 mt-1\">\r\n         <input type=\"checkbox\" checked={invertX} onChange={() => setInvertX(v => !v)} />\r\n         <span className=\"text-sm\">Invert X</span>\r\n       </label>\r\n       <label className=\"flex items-center gap-2 mt-1\">\r\n         <input type=\"checkbox\" checked={thirdPerson} onChange={() => setThirdPerson(v => !v)} />\r\n         <span className=\"text-sm\">Third-person</span>\r\n       </label>\r\n       <label className=\"flex items-center gap-2 mt-1\">\r\n         <input type=\"checkbox\" checked={usePhysicsEngine} onChange={() => setUsePhysicsEngine(v => !v)} />\r\n         <span className=\"text-sm\">Enable Physics Engine (cannon-es)</span>\r\n       </label>\r\n     </div>\r\n      <div className=\"absolute bottom-4 left-4 text-white bg-black bg-opacity-50 p-4 rounded\">\r\n        <div>{t('controlsWasd')}</div>\r\n        <div>{t('controlsSpace')}</div>\r\n        <div>{t('controlsShift')}</div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n// Tree creation (replaces the dense grass area)\r\nconst createTrees = (materials: any, count = 60, chunkSize = 50) => {\r\n  const group = new THREE.Group()\r\n  const trunkGeo = new THREE.CylinderGeometry(0.18, 0.25, 2, 8)\r\n  const coneGeo1 = new THREE.ConeGeometry(1.2, 2, 8)\r\n  const coneGeo2 = new THREE.ConeGeometry(0.8, 1.4, 8)\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const tree = new THREE.Group()\r\n\r\n    const trunk = new THREE.Mesh(trunkGeo, materials.trunk)\r\n    trunk.position.y = 1\r\n    trunk.castShadow = true\r\n    trunk.receiveShadow = true\r\n    tree.add(trunk)\r\n\r\n    const leaves1 = new THREE.Mesh(coneGeo1, materials.teaPlant)\r\n    leaves1.position.y = 2.2\r\n    leaves1.castShadow = true\r\n    tree.add(leaves1)\r\n\r\n    const leaves2 = new THREE.Mesh(coneGeo2, materials.teaPlant)\r\n    leaves2.position.y = 3.1\r\n    leaves2.castShadow = true\r\n    tree.add(leaves2)\r\n\r\n    const x = (Math.random() - 0.5) * chunkSize * 2\r\n    const z = (Math.random() - 0.5) * chunkSize * 2\r\n    tree.position.set(x, 0, z)\r\n    tree.rotation.y = Math.random() * Math.PI * 2\r\n    const s = 0.8 + Math.random() * 0.8\r\n    tree.scale.set(s, s, s)\r\n\r\n    group.add(tree)\r\n  }\r\n\r\n  return group\r\n}\r\n\r\n// (removed simple checkers board implementation to avoid duplicate declaration; use the detailed createCheckersBoard below)\r\n\r\n// New: create a checkers board with pieces\r\nconst createCheckersBoard = (materials: any, size = 8, squareSize = 1, opts?: { position?: THREE.Vector3 }) => {\r\n  const group = new THREE.Group()\r\n  const board = new THREE.Group()\r\n  const half = (size * squareSize) / 2\r\n\r\n  const darkMat = new THREE.MeshLambertMaterial({ color: 0x3b3b3b })\r\n  const lightMat = new THREE.MeshLambertMaterial({ color: 0xE0CDA2 })\r\n  const pieceBlack = new THREE.MeshLambertMaterial({ color: 0x111111 })\r\n  const pieceRed = new THREE.MeshLambertMaterial({ color: 0xAA2222 })\r\n\r\n  const squareGeo = new THREE.BoxGeometry(squareSize, 0.06, squareSize)\r\n  const pieceGeo = new THREE.CylinderGeometry(squareSize * 0.35, squareSize * 0.35, 0.25, 16)\r\n\r\n  for (let row = 0; row < size; row++) {\r\n    for (let col = 0; col < size; col++) {\r\n      const isDark = (row + col) % 2 === 1\r\n      const mat = isDark ? darkMat : lightMat\r\n      const sq = new THREE.Mesh(squareGeo, mat)\r\n      const x = col * squareSize - half + squareSize / 2\r\n      const z = row * squareSize - half + squareSize / 2\r\n      sq.position.set(x, 0, z)\r\n      sq.receiveShadow = true\r\n      board.add(sq)\r\n\r\n      // Place pieces on dark squares in first 3 and last 3 rows\r\n      if (isDark && (row < 3 || row >= size - 3)) {\r\n        const piece = new THREE.Mesh(pieceGeo, row < 3 ? pieceBlack : pieceRed)\r\n        piece.position.set(x, 0.16, z)\r\n        piece.castShadow = true\r\n        board.add(piece)\r\n      }\r\n    }\r\n  }\r\n\r\n  // thin board base\r\n  const baseGeo = new THREE.BoxGeometry(size * squareSize + 0.2, 0.1, size * squareSize + 0.2)\r\n  const baseMat = materials.stone || new THREE.MeshLambertMaterial({ color: 0x554433 })\r\n  const base = new THREE.Mesh(baseGeo, baseMat)\r\n  base.position.set(0, -0.05, 0)\r\n  base.receiveShadow = true\r\n  group.add(base)\r\n  group.add(board)\r\n\r\n  // position group if provided\r\n  if (opts?.position) {\r\n    group.position.copy(opts.position)\r\n  }\r\n\r\n  return group\r\n}\r\n\r\n// Hands creation for first-person view\r\nconst createHands = (materials: any) => {\r\n  const group = new THREE.Group()\r\n  // position relative to camera (in front, slightly down and to center)\r\n  group.position.set(0, -0.2, -0.5)\r\n\r\n  // left forearm\r\n  const armGeo = new THREE.BoxGeometry(0.18, 0.18, 0.5)\r\n  const handGeo = new THREE.BoxGeometry(0.14, 0.08, 0.2)\r\n  const mat = materials.wood || new THREE.MeshStandardMaterial({ color: 0xD1A17A })\r\n\r\n  const leftArm = new THREE.Mesh(armGeo, mat)\r\n  leftArm.position.set(-0.18, 0, -0.15)\r\n  leftArm.castShadow = true\r\n  group.add(leftArm)\r\n\r\n  const leftHand = new THREE.Mesh(handGeo, mat)\r\n  leftHand.position.set(-0.18, -0.12, -0.4)\r\n  leftHand.castShadow = true\r\n  group.add(leftHand)\r\n\r\n  // right forearm\r\n  const rightArm = new THREE.Mesh(armGeo, mat)\r\n  rightArm.position.set(0.18, 0, -0.15)\r\n  rightArm.castShadow = true\r\n  group.add(rightArm)\r\n\r\n  const rightHand = new THREE.Mesh(handGeo, mat)\r\n  rightHand.position.set(0.18, -0.12, -0.4)\r\n  rightHand.castShadow = true\r\n  group.add(rightHand)\r\n\r\n  // scale a bit and return\r\n  group.scale.set(0.9, 0.9, 0.9)\r\n  return group\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}